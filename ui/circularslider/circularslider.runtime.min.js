TW.Runtime.Widgets.circularslider=function(){var a=this,g=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),p=2*Math.PI,A=Math.PI/2,C=Math.PI/180,x=!1,h=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+g+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+g+'"></canvas></div>'};this.afterRender=function(){var q=a=>0>a?a+p:a>p?a-p:a,t=
a.getProperty("debugMode"),c=a.getProperty("numberOfKnobs"),u=a.getProperty("startAngle")*C,l=a.getProperty("sliderStrokeWidth"),m=a.getProperty("knobsRadius"),r=$(".widget-circularslider-"+g)[0];(new ResizeObserver(a.draw)).observe(r);var e=$(".widget-circularslider-canvas-"+g)[0];e.onmousemove=function(k){var f=a.getProperty("min"),n=a.getProperty("max")-f+1,g=p/(2*n),r=e.width/2,z=e.height/2;if(x){var d=q(Math.atan2(k.offsetY-z,k.offsetX-r)+A);d=q(d-u);d=q(d+g);k=a.getProperty("Value"+h);f=Math.floor(n*
d/p+f);k!==f&&(1<c?(n=a.getProperty("Value"+(1<h?h-1:c)),k=a.getProperty("Value"+(h<c?h+1:1)),t&&console.log("CircularSlider - editing - prevValue = "+n+", newValue = "+f+", nextValue = "+k),f!==n&&f!==k&&(a.setProperty("Value"+h,f),a.jqElement.triggerHandler("ValuesChanged"))):(a.setProperty("Value"+h,f),a.jqElement.triggerHandler("ValuesChanged")))}else{h=-1;g=Math.min(e.width,e.height)/2-l;for(var v=1;v<=c;v++){d=a.getProperty("Value"+v);d=p*(d-f)/n-A+u;var b=r+g*Math.cos(d)-k.offsetX;d=z+g*Math.sin(d)-
k.offsetY;Math.sqrt(b*b+d*d)<m&&(h=v)}}a.draw()};e.onmousedown=function(a){-1!==h&&(x=!0)};e.onmouseup=function(a){x=!1}};this.serviceInvoked=function(a){};this.draw=function(){var q=a.getProperty("numberOfKnobs"),t=a.getProperty("min"),c=a.getProperty("max"),u=a.getProperty("startAngle")*C,l=a.getProperty("sliderStrokeWidth"),m=a.getProperty("sliderBackgroundColor"),r=a.getProperty("knobsRadius"),e=a.getProperty("knobsFontSize"),k=a.getProperty("knobsBackgroundColor"),f=a.getProperty("knobsFontColor"),
n=a.getProperty("knobsBorderWidth"),x=a.getProperty("knobsBorderColor"),D=a.getProperty("knobSelectedBorderColor"),z=a.getProperty("knobsFormatFunction"),d=a.getProperty("showValuesSummary"),v=c-t+1;c=$(".widget-circularslider-"+g)[0];var b=$(".widget-circularslider-canvas-"+g)[0];if(c&&b){b.width=c.offsetWidth-1;b.height=c.offsetHeight-1;var B=Math.min(b.width,b.height)/2-l;c=b.width/2;var y=b.height/2;b=b.getContext("2d");b.font=e+"px sans-serif";b.lineWidth=l;b.strokeStyle=m;b.beginPath();b.arc(c,
y,B,0,2*Math.PI);b.stroke();l=[];for(m=1;m<=q;m++){l[m]=a.getProperty("Value"+m);eval("try {var result;var value = "+l[m]+";"+z+"} catch (exception) {console.log(exception);}");var w=p*(l[m]-t)/v-A+u;e=B*Math.cos(w);w=B*Math.sin(w);b.fillStyle=k;b.beginPath();b.arc(c+e,y+w,r,0,2*Math.PI);b.fill();b.lineWidth=n;b.strokeStyle=h===m?D:x;b.beginPath();b.arc(c+e,y+w,r,0,2*Math.PI);b.stroke();b.textBaseline="middle";b.lineWidth=1;b.fillStyle=f;b.fillText(result,c+e-b.measureText(result).width/2,y+w)}d&&
(q=a.getProperty("valuesSummaryFormatFunction"),t=a.getProperty("valuesSummaryFontSize"),u=a.getProperty("valuesSummaryFontColor"),l=l.slice(1),l.sort((a,b)=>a-b),eval("try {var result;"+q+"} catch (exception) {console.log(exception);}"),b.font=t+"px sans-serif",b.textBaseline="middle",b.lineWidth=1,b.fillStyle=u,b.fillText(result,c-b.measureText(result).width/2,y))}}};