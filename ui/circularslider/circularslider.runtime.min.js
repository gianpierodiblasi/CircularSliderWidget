TW.Runtime.Widgets.circularslider=function(){var a=this,l=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),u=2*Math.PI,z=Math.PI/2,A=Math.PI/180,v=!1,g=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+l+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+l+'"></canvas></div>'};this.afterRender=function(){var w=a.getProperty("debugMode"),
p=a.getProperty("numberOfKnobs"),r=a.getProperty("startAngle")*A,C=a.getProperty("sliderStrokeWidth"),n=a.getProperty("knobsRadius"),e=$(".widget-circularslider-"+l)[0];(new ResizeObserver(a.draw)).observe(e);var h=$(".widget-circularslider-canvas-"+l)[0];h.onmousemove=function(c){var f=a.getProperty("min"),e=a.getProperty("max")-f+1,l=h.width/2,x=h.height/2;if(v){var d=Math.atan2(c.offsetY-x,c.offsetX-l)+z;0>d&&(d+=u);d-=r;0>d&&(d+=u);c=a.getProperty("Value"+g);f=Math.floor(e*d/u+f);c!==f&&(1<p?
(e=a.getProperty("Value"+(1<g?g-1:p)),c=a.getProperty("Value"+(g<p?g+1:1)),w&&console.log("CircularSlider - editing - prevValue = "+e+", newValue = "+f+", nextValue = "+c),f!==e&&f!==c&&(a.setProperty("Value"+g,f),a.jqElement.triggerHandler("ValuesChanged"))):(a.setProperty("Value"+g,f),a.jqElement.triggerHandler("ValuesChanged")))}else{g=-1;for(var k=Math.min(h.width,h.height)/2-C,b=1;b<=p;b++){d=a.getProperty("Value"+b);d=u*(d-f)/e-z+r;var q=l+k*Math.cos(d)-c.offsetX;d=x+k*Math.sin(d)-c.offsetY;
Math.sqrt(q*q+d*d)<n&&(g=b)}}a.draw()};h.onmousedown=function(a){-1!==g&&(v=!0)};h.onmouseup=function(a){v=!1}};this.serviceInvoked=function(a){};this.draw=function(){var w=a.getProperty("numberOfKnobs"),p=a.getProperty("min"),r=a.getProperty("max"),v=a.getProperty("startAngle")*A,n=a.getProperty("sliderStrokeWidth"),e=a.getProperty("sliderBackgroundColor"),h=a.getProperty("knobsRadius"),c=a.getProperty("knobsMaxFontSize"),f=a.getProperty("knobsBackgroundColor"),D=a.getProperty("knobsFontColor"),
B=a.getProperty("knobsBorderWidth"),x=a.getProperty("knobsBorderColor"),d=a.getProperty("knobSelectedBorderColor");r=r-p+1;var k=$(".widget-circularslider-"+l)[0],b=$(".widget-circularslider-canvas-"+l)[0];if(k&&b){b.width=k.offsetWidth-1;b.height=k.offsetHeight-1;k=Math.min(b.width,b.height)/2-n;var q=b.width/2,y=b.height/2;b=b.getContext("2d");b.lineWidth=n;b.strokeStyle=e;b.beginPath();b.arc(q,y,k,0,2*Math.PI);b.stroke();n=[];e=[];var t=c;for(c=1;c<=w;c++){var m=!1;n[c]=a.getProperty("Value"+c);
var E=a.getProperty("knobsFormatFunction");eval("try {var result;var value = "+n[c]+";"+E+"} catch (exception) {console.log(exception);}");for(e[c]=result;!m;)b.font=t+"px sans-serif",(m=b.measureText(e[c]).width<2*(h-B-2))||t--}for(c=1;c<=w;c++)m=u*(n[c]-p)/r-z+v,t=k*Math.cos(m),m=k*Math.sin(m),b.fillStyle=f,b.beginPath(),b.arc(q+t,y+m,h,0,2*Math.PI),b.fill(),b.lineWidth=B,b.strokeStyle=g===c?d:x,b.beginPath(),b.arc(q+t,y+m,h,0,2*Math.PI),b.stroke(),b.textBaseline="middle",b.lineWidth=1,b.fillStyle=
D,b.fillText(e[c],q+t-b.measureText(e[c]).width/2,y+m)}}};