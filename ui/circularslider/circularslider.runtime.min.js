TW.Runtime.Widgets.circularslider=function(){var a=this,m=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),p=2*Math.PI,B=Math.PI/2,C=Math.PI/180,y=!1,g=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+m+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+m+'"></canvas></div>'};this.afterRender=function(){var q=a=>0>a?a+p:a>p?a-p:a,u=
a.getProperty("debugMode"),c=a.getProperty("numberOfKnobs"),v=a.getProperty("startAngle")*C,k=a.getProperty("sliderStrokeWidth"),l=a.getProperty("knobsRadius"),r=$(".widget-circularslider-"+m)[0];(new ResizeObserver(a.draw)).observe(r);var e=$(".widget-circularslider-canvas-"+m)[0];e.onmousemove=function(h){var f=a.getProperty("min"),n=a.getProperty("max")-f+1,t=p/(2*n),m=e.width/2,r=e.height/2;if(y){var d=q(Math.atan2(h.offsetY-r,h.offsetX-m)+B);d=q(d-v);d=q(d+t);h=a.getProperty("Value"+g);f=Math.floor(n*
d/p+f);h!==f&&(1<c?(n=a.getProperty("Value"+(1<g?g-1:c)),h=a.getProperty("Value"+(g<c?g+1:1)),u&&console.log("CircularSlider - editing - prevValue = "+n+", newValue = "+f+", nextValue = "+h),f!==n&&f!==h&&(a.setProperty("Value"+g,f),a.jqElement.triggerHandler("ValuesChanged"),a.draw())):(a.setProperty("Value"+g,f),a.jqElement.triggerHandler("ValuesChanged"),a.draw()))}else{t=-1;for(var A=Math.min(e.width,e.height)/2-k,b=1;b<=c;b++){d=a.getProperty("Value"+b);d=p*(d-f)/n-B+v;var w=m+A*Math.cos(d)-
h.offsetX;d=r+A*Math.sin(d)-h.offsetY;Math.sqrt(w*w+d*d)<l&&(t=b)}t!==g&&(g=t,a.draw())}};e.onmousedown=function(a){-1!==g&&(y=!0)};e.onmouseup=function(a){y=!1}};this.serviceInvoked=function(a){};this.draw=function(){var q=a.getProperty("numberOfKnobs"),u=a.getProperty("min"),c=a.getProperty("max"),v=a.getProperty("startAngle")*C,k=a.getProperty("sliderStrokeWidth"),l=a.getProperty("sliderBackgroundColor"),r=a.getProperty("knobsRadius"),e=a.getProperty("knobsFontSize"),h=a.getProperty("knobsBackgroundColor"),
f=a.getProperty("knobsFontColor"),n=a.getProperty("knobsBorderWidth"),t=a.getProperty("knobsBorderColor"),y=a.getProperty("knobSelectedBorderColor"),D=a.getProperty("knobsFormatFunction"),d=a.getProperty("showValuesSummary"),A=c-u+1;c=$(".widget-circularslider-"+m)[0];var b=$(".widget-circularslider-canvas-"+m)[0];if(c&&b){b.width=c.offsetWidth-1;b.height=c.offsetHeight-1;var w=Math.min(b.width,b.height)/2-k;c=b.width/2;var z=b.height/2;b=b.getContext("2d");b.font=e+"px sans-serif";b.lineWidth=k;
b.strokeStyle=l;b.beginPath();b.arc(c,z,w,0,2*Math.PI);b.stroke();k=[];for(l=1;l<=q;l++){k[l]=a.getProperty("Value"+l);eval("try {var result;var value = "+k[l]+";"+D+"} catch (exception) {console.log(exception);}");var x=p*(k[l]-u)/A-B+v;e=w*Math.cos(x);x=w*Math.sin(x);b.fillStyle=h;b.beginPath();b.arc(c+e,z+x,r,0,2*Math.PI);b.fill();b.lineWidth=n;b.strokeStyle=g===l?y:t;b.beginPath();b.arc(c+e,z+x,r,0,2*Math.PI);b.stroke();b.textBaseline="middle";b.lineWidth=1;b.fillStyle=f;b.fillText(result,c+e-
b.measureText(result).width/2,z+x)}d&&(q=a.getProperty("valuesSummaryFormatFunction"),u=a.getProperty("valuesSummaryFontSize"),v=a.getProperty("valuesSummaryFontColor"),k=k.slice(1),k.sort((a,b)=>a-b),eval("try {var result;"+q+"} catch (exception) {console.log(exception);}"),b.font=u+"px sans-serif",b.textBaseline="middle",b.lineWidth=1,b.fillStyle=v,b.fillText(result,c-b.measureText(result).width/2,z))}}};