TW.Runtime.Widgets.circularslider=function(){var a=this,E=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),x=2*Math.PI,F=Math.PI/2,N=Math.PI/180,H=!1,u=-1,A=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+E+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+E+'"></canvas></div>'};this.afterRender=function(){var f=a=>0>a?a+x:a>x?a-x:
a,q=a.getProperty("debugMode"),m=a.getProperty("numberOfKnobs"),r=a.getProperty("startAngle")*N,v=a.getProperty("sliderStrokeWidth"),k=a.getProperty("knobsRadius"),e=a.getProperty("animation"),B=a.getProperty("showTicks"),K=a.getProperty("showTicksTooltip"),I=a.getProperty("primaryTicksStep"),C=a.getProperty("primaryTicksRadius"),J=a.getProperty("secondaryTicksRadius"),L=a.getProperty("ticksTooltipFormatFunction"),M=$(".widget-circularslider-"+E)[0];(new ResizeObserver(a.draw)).observe(M);var t=$(".widget-circularslider-canvas-"+
E)[0];t.onmousemove=function(p){var l=a.getProperty("min"),n=a.getProperty("max"),w=n-l+1,D=x/(2*w),g=t.width/2,b=t.height/2;if(H)A=f(Math.atan2(p.offsetY-b,p.offsetX-g)+F),A=f(A-r),A=f(A+D),p=a.getProperty("Value"+u),l=Math.floor(w*A/x+l),p!==l?1<m?(w=a.getProperty("Value"+(1<u?u-1:m)),p=a.getProperty("Value"+(u<m?u+1:1)),q&&console.log("CircularSlider - editing - prevValue = "+w+", newValue = "+l+", nextValue = "+p),l!==w&&l!==p?(a.setProperty("Value"+u,l),a.jqElement.triggerHandler("ValuesChanged"),
a.draw()):"SMOOTH"===e&&a.draw()):(a.setProperty("Value"+u,l),a.jqElement.triggerHandler("ValuesChanged"),a.draw()):"SMOOTH"===e&&a.draw();else{D=-1;t.title="";for(var y=Math.min(t.width,t.height)/2-v,d=1;d<=m;d++){var z=a.getProperty("Value"+d),c=x*(z-l)/w-F+r,h=y*Math.cos(c);c=y*Math.sin(c);h=g+h-p.offsetX;c=b+c-p.offsetY;Math.sqrt(h*h+c*c)<k&&(D=d)}if("NO"!==B&&K)for(z=l;z<=n;z++){c=x*(z-l)/w-F+r;h=y*Math.cos(c);c=y*Math.sin(c);h=g+h-p.offsetX;c=b+c-p.offsetY;d=!1;switch(B){case "PRIMARY":d=0===
(z-l)%I&&Math.sqrt(h*h+c*c)<C;break;case "SECONDARY":d=Math.sqrt(h*h+c*c)<J;break;case "ALL":d=(d=0===(z-l)%I)&&Math.sqrt(h*h+c*c)<C||!d&&Math.sqrt(h*h+c*c)<J}d&&(eval("try {var result;"+L+"} catch (exception) {console.log(exception);}"),t.title=result)}D!==u&&(u=D,a.draw())}};t.onmousedown=function(a){-1!==u&&(t.title="",H=!0)};t.onmouseup=function(f){t.title="";H=!1;"SMOOTH"===e&&a.draw()}};this.serviceInvoked=function(a){};this.draw=function(){var f=a.getProperty("numberOfKnobs"),q=a.getProperty("min"),
m=a.getProperty("max"),r=a.getProperty("startAngle")*N,v=a.getProperty("sliderStrokeWidth"),k=a.getProperty("sliderBackgroundColor"),e=a.getProperty("knobsRadius"),B=a.getProperty("knobsFontSize"),K=a.getProperty("knobsBackgroundColor"),I=a.getProperty("knobsFontColor"),C=a.getProperty("knobsFontFamily"),J=a.getProperty("knobsBorderWidth"),L=a.getProperty("knobsBorderColor"),M=a.getProperty("knobSelectedBorderColor"),t=a.getProperty("knobsFormatFunction"),p=a.getProperty("showValuesSummary"),l=a.getProperty("animation"),
n=a.getProperty("showTicks"),w=m-q+1,D=x/(2*w),g=$(".widget-circularslider-"+E)[0],b=$(".widget-circularslider-canvas-"+E)[0];if(g&&b){b.width=g.offsetWidth-1;b.height=g.offsetHeight-1;var y=Math.min(b.width,b.height)/2-v;g=b.width/2;var d=b.height/2;b=b.getContext("2d");b.font=B+"px "+C;b.lineWidth=v;b.strokeStyle=k;b.beginPath();b.arc(g,d,y,0,2*Math.PI);b.stroke();if("NO"!==n){B=a.getProperty("primaryTicksStep");C=a.getProperty("primaryTicksRadius");for(var z=a.getProperty("secondaryTicksRadius"),
c=a.getProperty("primaryTicksColor"),h=a.getProperty("secondaryTicksColor"),G=q;G<=m;G++)switch(k=x*(G-q)/w-F+r,v=y*Math.cos(k),k=y*Math.sin(k),n){case "PRIMARY":0===(G-q)%B&&(b.fillStyle=c,b.beginPath(),b.arc(g+v,d+k,C,0,2*Math.PI),b.fill());break;case "SECONDARY":b.fillStyle=h;b.beginPath();b.arc(g+v,d+k,z,0,2*Math.PI);b.fill();break;case "ALL":var O=0===(G-q)%B;b.fillStyle=O?c:h;b.beginPath();b.arc(g+v,d+k,O?C:z,0,2*Math.PI);b.fill()}}m=[];for(n=1;n<=f;n++)m[n]=a.getProperty("Value"+n),eval("try {var result;var value = "+
m[n]+";"+t+"} catch (exception) {console.log(exception);}"),k=H&&"SMOOTH"===l&&u===n?A-F+r-D:x*(m[n]-q)/w-F+r,v=y*Math.cos(k),k=y*Math.sin(k),b.fillStyle=K,b.beginPath(),b.arc(g+v,d+k,e,0,2*Math.PI),b.fill(),b.lineWidth=J,b.strokeStyle=u===n?M:L,b.beginPath(),b.arc(g+v,d+k,e,0,2*Math.PI),b.stroke(),b.textBaseline="middle",b.lineWidth=1,b.fillStyle=I,b.fillText(result,g+v-b.measureText(result).width/2,d+k);if(p)if(f=a.getProperty("valuesSummaryFormatFunction"),q=a.getProperty("valuesSummaryFontSize"),
r=a.getProperty("valuesSummaryFontColor"),e=a.getProperty("valuesSummaryFontFamily"),m=m.slice(1),m.sort((a,b)=>a-b),eval("try {var result;"+f+"} catch (exception) {console.log(exception);}"),b.font=q+"px "+e,b.textBaseline="middle",b.lineWidth=1,b.fillStyle=r,f=result.split("\n"),q=Math.floor(f.length/2),r=1.5*b.measureText("M").width,1===f.length)b.fillText(result,g-b.measureText(result).width/2,d);else if(0===f.length%2)for(e=0;e<f.length;e++)b.fillText(f[e],g-b.measureText(f[e]).width/2,d-r*(q-
e)+r/2);else for(e=0;e<f.length;e++)b.fillText(f[e],g-b.measureText(f[e]).width/2,d-r*(q-e))}}};