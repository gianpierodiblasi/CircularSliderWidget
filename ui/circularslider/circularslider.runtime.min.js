TW.Runtime.Widgets.circularslider=function(){var a=this,v=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),r=2*Math.PI,C=Math.PI/2,N=Math.PI/180,F=!1,p=-1,z=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+v+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+v+'"></canvas></div>'};this.afterRender=function(){var A=a=>0>a?a+r:a>r?a-r:
a,t=a.getProperty("debugMode"),h=a.getProperty("numberOfKnobs"),w=a.getProperty("startAngle")*N,q=a.getProperty("sliderStrokeWidth"),e=a.getProperty("knobsRadius"),D=a.getProperty("animation"),B=a.getProperty("showTicks"),J=a.getProperty("showTicksTooltip"),G=a.getProperty("primaryTicksStep"),H=a.getProperty("primaryTicksRadius"),I=a.getProperty("secondaryTicksRadius"),K=a.getProperty("ticksTooltipFormatFunction"),L=$(".widget-circularslider-"+v)[0];(new ResizeObserver(a.draw)).observe(L);var m=$(".widget-circularslider-canvas-"+
v)[0];m.onmousemove=function(l){var c=a.getProperty("min"),v=a.getProperty("max"),x=v-c+1,f=r/(2*x),b=m.width/2,y=m.height/2;if(F)z=A(Math.atan2(l.offsetY-y,l.offsetX-b)+C),z=A(z-w),z=A(z+f),l=a.getProperty("Value"+p),c=Math.floor(x*z/r+c),l!==c?1<h?(x=a.getProperty("Value"+(1<p?p-1:h)),l=a.getProperty("Value"+(p<h?p+1:1)),t&&console.log("CircularSlider - editing - prevValue = "+x+", newValue = "+c+", nextValue = "+l),c!==x&&c!==l?(a.setProperty("Value"+p,c),a.jqElement.triggerHandler("ValuesChanged"),
a.draw()):"SMOOTH"===D&&a.draw()):(a.setProperty("Value"+p,c),a.jqElement.triggerHandler("ValuesChanged"),a.draw()):"SMOOTH"===D&&a.draw();else{f=-1;m.title="";for(var n=Math.min(m.width,m.height)/2-q,k=1;k<=h;k++){var u=a.getProperty("Value"+k),d=r*(u-c)/x-C+w,g=n*Math.cos(d);d=n*Math.sin(d);g=b+g-l.offsetX;d=y+d-l.offsetY;Math.sqrt(g*g+d*d)<e&&(f=k)}if("NO"!==B&&J)for(u=c;u<=v;u++){d=r*(u-c)/x-C+w;g=n*Math.cos(d);d=n*Math.sin(d);g=b+g-l.offsetX;d=y+d-l.offsetY;k=!1;switch(B){case "PRIMARY":k=0===
(u-c)%G&&Math.sqrt(g*g+d*d)<H;break;case "SECONDARY":k=Math.sqrt(g*g+d*d)<I;break;case "ALL":k=(k=0===(u-c)%G)&&Math.sqrt(g*g+d*d)<H||!k&&Math.sqrt(g*g+d*d)<I}k&&(eval("try {var result;"+K+"} catch (exception) {console.log(exception);}"),m.title=result)}f!==p&&(p=f,a.draw())}};m.onmousedown=function(a){-1!==p&&(m.title="",F=!0)};m.onmouseup=function(e){m.title="";F=!1;"SMOOTH"===D&&a.draw()}};this.serviceInvoked=function(a){};this.draw=function(){var A=a.getProperty("numberOfKnobs"),t=a.getProperty("min"),
h=a.getProperty("max"),w=a.getProperty("startAngle")*N,q=a.getProperty("sliderStrokeWidth"),e=a.getProperty("sliderBackgroundColor"),D=a.getProperty("knobsRadius"),B=a.getProperty("knobsFontSize"),J=a.getProperty("knobsBackgroundColor"),G=a.getProperty("knobsFontColor"),H=a.getProperty("knobsBorderWidth"),I=a.getProperty("knobsBorderColor"),K=a.getProperty("knobSelectedBorderColor"),L=a.getProperty("knobsFormatFunction"),m=a.getProperty("showValuesSummary"),l=a.getProperty("animation"),c=a.getProperty("showTicks"),
M=h-t+1,x=r/(2*M),f=$(".widget-circularslider-"+v)[0],b=$(".widget-circularslider-canvas-"+v)[0];if(f&&b){b.width=f.offsetWidth-1;b.height=f.offsetHeight-1;var y=Math.min(b.width,b.height)/2-q;f=b.width/2;var n=b.height/2;b=b.getContext("2d");b.font=B+"px sans-serif";b.lineWidth=q;b.strokeStyle=e;b.beginPath();b.arc(f,n,y,0,2*Math.PI);b.stroke();if("NO"!==c){B=a.getProperty("primaryTicksStep");for(var k=a.getProperty("primaryTicksRadius"),u=a.getProperty("secondaryTicksRadius"),d=a.getProperty("primaryTicksColor"),
g=a.getProperty("secondaryTicksColor"),E=t;E<=h;E++)switch(e=r*(E-t)/M-C+w,q=y*Math.cos(e),e=y*Math.sin(e),c){case "PRIMARY":0===(E-t)%B&&(b.fillStyle=d,b.beginPath(),b.arc(f+q,n+e,k,0,2*Math.PI),b.fill());break;case "SECONDARY":b.fillStyle=g;b.beginPath();b.arc(f+q,n+e,u,0,2*Math.PI);b.fill();break;case "ALL":var O=0===(E-t)%B;b.fillStyle=O?d:g;b.beginPath();b.arc(f+q,n+e,O?k:u,0,2*Math.PI);b.fill()}}h=[];for(c=1;c<=A;c++)h[c]=a.getProperty("Value"+c),eval("try {var result;var value = "+h[c]+";"+
L+"} catch (exception) {console.log(exception);}"),e=F&&"SMOOTH"===l&&p===c?z-C+w-x:r*(h[c]-t)/M-C+w,q=y*Math.cos(e),e=y*Math.sin(e),b.fillStyle=J,b.beginPath(),b.arc(f+q,n+e,D,0,2*Math.PI),b.fill(),b.lineWidth=H,b.strokeStyle=p===c?K:I,b.beginPath(),b.arc(f+q,n+e,D,0,2*Math.PI),b.stroke(),b.textBaseline="middle",b.lineWidth=1,b.fillStyle=G,b.fillText(result,f+q-b.measureText(result).width/2,n+e);m&&(A=a.getProperty("valuesSummaryFormatFunction"),t=a.getProperty("valuesSummaryFontSize"),w=a.getProperty("valuesSummaryFontColor"),
h=h.slice(1),h.sort((a,b)=>a-b),eval("try {var result;"+A+"} catch (exception) {console.log(exception);}"),b.font=t+"px sans-serif",b.textBaseline="middle",b.lineWidth=1,b.fillStyle=w,b.fillText(result,f-b.measureText(result).width/2,n))}}};