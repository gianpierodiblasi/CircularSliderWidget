TW.Runtime.Widgets.circularslider=function(){var a=this,m=(new Date).getTime()+"_"+Math.floor(1E3*Math.random()),r=2*Math.PI,A=Math.PI/2,C=Math.PI/180,t=!1,h=-1;this.runtimeProperties=function(){return{needsDataLoadingAndError:!1}};this.renderHtml=function(){return'<div class="widget-content widget-circularslider widget-circularslider-'+m+'">  <canvas class="widget-circularslider-canvas widget-circularslider-canvas-'+m+'"></canvas></div>'};this.afterRender=function(){var u=a.getProperty("debugMode"),
n=a.getProperty("numberOfKnobs"),f=a.getProperty("startAngle")*C,v=a.getProperty("sliderStrokeWidth"),k=a.getProperty("knobsRadius"),c=$(".widget-circularslider-"+m)[0];(new ResizeObserver(a.draw)).observe(c);var l=$(".widget-circularslider-canvas-"+m)[0];l.onmousemove=function(e){var g=a.getProperty("min"),c=a.getProperty("max")-g+1,m=l.width/2,x=l.height/2;if(t){var d=Math.atan2(e.offsetY-x,e.offsetX-m)+A;0>d&&(d+=r);d-=f;0>d&&(d+=r);e=a.getProperty("Value"+h);g=Math.floor(c*d/r+g);e!==g&&(1<n?
(c=a.getProperty("Value"+(1<h?h-1:n)),e=a.getProperty("Value"+(h<n?h+1:1)),u&&console.log("CircularSlider - editing - prevValue = "+c+", newValue = "+g+", nextValue = "+e),g!==c&&g!==e&&(a.setProperty("Value"+h,g),a.jqElement.triggerHandler("ValuesChanged"))):(a.setProperty("Value"+h,g),a.jqElement.triggerHandler("ValuesChanged")))}else{h=-1;for(var y=Math.min(l.width,l.height)/2-v,p=1;p<=n;p++){d=a.getProperty("Value"+p);d=r*(d-g)/c-A+f;var z=m+y*Math.cos(d)-e.offsetX;d=x+y*Math.sin(d)-e.offsetY;
Math.sqrt(z*z+d*d)<k&&(h=p)}}a.draw()};l.onmousedown=function(a){-1!==h&&(t=!0)};l.onmouseup=function(a){t=!1}};this.serviceInvoked=function(a){};this.draw=function(){var u=a.getProperty("numberOfKnobs"),n=a.getProperty("min"),f=a.getProperty("max"),v=a.getProperty("startAngle")*C,k=a.getProperty("sliderStrokeWidth"),c=a.getProperty("sliderBackgroundColor"),l=a.getProperty("knobsRadius"),e=a.getProperty("knobsFontSize"),g=a.getProperty("knobsBackgroundColor"),t=a.getProperty("knobsFontColor"),D=a.getProperty("knobsBorderWidth"),
x=a.getProperty("knobsBorderColor"),d=a.getProperty("knobSelectedBorderColor"),y=a.getProperty("knobsFormatFunction"),p=a.getProperty("showValuesSummary"),z=f-n+1;f=$(".widget-circularslider-"+m)[0];var b=$(".widget-circularslider-canvas-"+m)[0];if(f&&b){b.width=f.offsetWidth-1;b.height=f.offsetHeight-1;var B=Math.min(b.width,b.height)/2-k;f=b.width/2;var w=b.height/2;b=b.getContext("2d");b.font=e+"px sans-serif";b.lineWidth=k;b.strokeStyle=c;b.beginPath();b.arc(f,w,B,0,2*Math.PI);b.stroke();k=[];
for(c=1;c<=u;c++){k[c]=a.getProperty("Value"+c);eval("try {var result;var value = "+k[c]+";"+y+"} catch (exception) {console.log(exception);}");var q=r*(k[c]-n)/z-A+v;e=B*Math.cos(q);q=B*Math.sin(q);b.fillStyle=g;b.beginPath();b.arc(f+e,w+q,l,0,2*Math.PI);b.fill();b.lineWidth=D;b.strokeStyle=h===c?d:x;b.beginPath();b.arc(f+e,w+q,l,0,2*Math.PI);b.stroke();b.textBaseline="middle";b.lineWidth=1;b.fillStyle=t;b.fillText(result,f+e-b.measureText(result).width/2,w+q)}p&&(u=a.getProperty("valuesSummaryFormatFunction"),
n=a.getProperty("valuesSummaryFontSize"),v=a.getProperty("valuesSummaryFontColor"),k=k.slice(1),k.sort((a,b)=>a-b),eval("try {var result;"+u+"} catch (exception) {console.log(exception);}"),b.font=n+"px sans-serif",b.textBaseline="middle",b.lineWidth=1,b.fillStyle=v,b.fillText(result,f-b.measureText(result).width/2,w))}}};